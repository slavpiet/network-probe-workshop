---
- name: "Step 6: Deploy Suricata IDS"
  hosts: all
  become: yes
  
  # vars:
  #   base_directory: "/opt/network-sensors"
  #   logs_directory: "/data2/logs"
  #   suricata_log_path: "{{ logs_directory }}/suricata"
  #   suricata_version: "8.0.1"
  #   capture_interface: "eno4"
  #   suricata_home_net: "192.168.0.0/16"
  
  tasks:
    - name: Display deployment phase
      debug:
        msg:
          - "=========================================="
          - "PHASE 6: SURICATA DEPLOYMENT"
          - "=========================================="
          - "Version: {{ suricata_version }}"
          - "Interface: {{ capture_interface }}"
          - "Home Network: {{ suricata_home_net }}"
          - "=========================================="
      tags: ['always']

    - name: Deploy Suricata
      import_role:
        name: suricata
      tags: ['suricata']

    - name: Display completion
      debug:
        msg:
          - "=========================================="
          - "PHASE 6: COMPLETED"
          - "=========================================="
          - "Suricata is running!"
          - "Logs: {{ suricata_log_path }}/"
          - "View alerts: tail -f {{ suricata_log_path }}/fast.log"
          - "View EVE: tail -f {{ suricata_log_path }}/eve.json"
          - "=========================================="
      tags: ['always']
